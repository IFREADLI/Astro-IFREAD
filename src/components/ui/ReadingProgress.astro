---
// 阅读进度条组件
// 显示文章阅读进度
---

<div id="reading-progress" class="fixed top-0 left-0 w-full h-1 bg-border z-50">
  <div id="reading-progress-bar" class="h-full bg-accent transition-all duration-300 ease-out" style="width: 0%"></div>
</div>

<script>
  // 阅读进度条逻辑
  document.addEventListener('DOMContentLoaded', () => {
    const progressBar = document.getElementById('reading-progress-bar');
    if (!progressBar) return;
    
    // 获取文章内容元素
    const article = document.querySelector('article');
    if (!article) return;
    
    // 计算阅读进度
    function updateProgress() {
      // 获取文章元素的位置和高度
      const articleTop = article.offsetTop;
      const articleHeight = article.offsetHeight;
      
      // 获取当前滚动位置
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const windowHeight = window.innerHeight;
      
      // 计算进度百分比
      let progress = 0;
      
      // 当文章开始进入视口时开始计算进度
      if (scrollTop > articleTop - windowHeight) {
        // 计算已滚动的距离
        const scrolled = scrollTop - (articleTop - windowHeight);
        // 计算总滚动距离（文章高度 + 视口高度）
        const totalScroll = articleHeight + windowHeight;
        // 计算进度百分比
        progress = Math.min(scrolled / totalScroll, 1);
      }
      
      // 更新进度条宽度
      progressBar.style.width = `${progress * 100}%`;
    }
    
    // 监听滚动事件
    window.addEventListener('scroll', updateProgress);
    
    // 初始化进度
    updateProgress();
    
    // 监听窗口大小变化
    window.addEventListener('resize', updateProgress);
  });
</script>